{% extends "layout.html" %}

{% block content %}
<div class="page-container">
    <header class="page-header">
        <h1>Gestión de Aplicantes</h1>
        <p>Para la oferta: <strong>{{ oferta.titulo }}</strong></p>
    </header>

    <div class="pipeline-board">
        <!-- Columna 1: Nuevos Aplicantes -->
        <div class="pipeline-column">
            <div class="column-header">
                <h3>Nuevos Aplicantes ({{ nuevos|length }})</h3>
            </div>
            <!-- PISTA 1: "data-state" le dice al JS el estado de esta columna -->
            <div class="column-cards" id="nuevos-aplicantes" data-state="Enviada">
                {% for postulacion in nuevos %}
                <!-- PISTA 2: "data-id" le dice al JS el ID único de esta tarjeta -->
                <div class="applicant-card" data-id="{{ postulacion.id }}">
                    <div class="card-info">
                        <img src="{{ postulacion.perfil.foto_perfil_url or '/static/img/perfil_placeholder.png' }}" alt="Foto de perfil" class="applicant-picture">
                        <div>
                            <h4 class="applicant-name">{{ postulacion.perfil.nombre_completo }}</h4>
                            <p class="applicant-title">{{ postulacion.perfil.titular }}</p>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn-icon" title="Ver Perfil"><i class="fas fa-eye"></i></button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Columna 2: En Revisión -->
        <div class="pipeline-column">
            <div class="column-header">
                <h3>En Revisión ({{ revision|length }})</h3>
            </div>
            <!-- PISTA 1: "data-state" para esta columna -->
            <div class="column-cards" id="en-revision" data-state="En Revisión">
                {% for postulacion in revision %}
                <!-- PISTA 2: "data-id" para esta tarjeta -->
                <div class="applicant-card" data-id="{{ postulacion.id }}">
                     <div class="card-info">
                        <img src="{{ postulacion.perfil.foto_perfil_url or '/static/img/perfil_placeholder.png' }}" alt="Foto de perfil" class="applicant-picture">
                        <div>
                            <h4 class="applicant-name">{{ postulacion.perfil.nombre_completo }}</h4>
                            <p class="applicant-title">{{ postulacion.perfil.titular }}</p>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn-icon" title="Ver Perfil"><i class="fas fa-eye"></i></button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Columna 3: Entrevista -->
        <div class="pipeline-column">
            <div class="column-header">
                <h3>Entrevista ({{ entrevistas|length }})</h3>
            </div>
            <div class="column-cards" id="entrevista" data-state="Entrevista">
                {% for postulacion in entrevistas %}
                <div class="applicant-card" data-id="{{ postulacion.id }}">
                    <div class="card-info">
                        <img src="{{ postulacion.perfil.foto_perfil_url or '/static/img/perfil_placeholder.png' }}" alt="Foto de perfil" class="applicant-picture">
                        <div>
                            <h4 class="applicant-name">{{ postulacion.perfil.nombre_completo }}</h4>
                            <p class="applicant-title">{{ postulacion.perfil.titular }}</p>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn-icon" title="Ver Perfil"><i class="fas fa-eye"></i></button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Columna 4: Contratado -->
        <div class="pipeline-column">
            <div class="column-header">
                <h3>Contratado ({{ contratados|length }})</h3>
            </div>
            <div class="column-cards" id="contratado" data-state="Contratado">
                {% for postulacion in contratados %}
                <div class="applicant-card" data-id="{{ postulacion.id }}">
                    <div class="card-info">
                        <img src="{{ postulacion.perfil.foto_perfil_url or '/static/img/perfil_placeholder.png' }}" alt="Foto de perfil" class="applicant-picture">
                        <div>
                            <h4 class="applicant-name">{{ postulacion.perfil.nombre_completo }}</h4>
                            <p class="applicant-title">{{ postulacion.perfil.titular }}</p>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn-icon" title="Ver Perfil"><i class="fas fa-eye"></i></button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
